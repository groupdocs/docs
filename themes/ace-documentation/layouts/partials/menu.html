<nav class="navbar navbar-expand-md navbar-light pl-0">
    <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#sidenav-left-collapse" aria-controls="sidenav-left-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

     <div class="collapse navbar-collapse align-items-start flex-column" id="sidenav-left-collapse">
        {{- if not .Site.Params.disableSearch }}
        {{- if not .Params.disableSearch }}
            <form class="form-inline my-2 my-lg-0 searchbox">
                <input class="form-control mr-sm-2 w-100" data-search-input id="search-by" type="text" placeholder="Search">
            </form>
        {{- end}}
        {{- end}}
         <ul class="navbar-nav flex-column pt-3">
         
          <!-- ----------------------- MENU FOR CURRENT SECTION ONLY ----------------------- -->                
              {{ $menuSection := default "annotation-net" .Section  }}
              {{ if eq $menuSection "*" }}
                {{ $menuSection = "/" }}
              {{ end }}      

              {{ with .Site.GetPage $menuSection }}
                {{ template "section-children" (dict "Section" . "CurrentPage" $) }}
              {{ end }}  

              {{ define "section-children" }}
                {{ $self := eq .CurrentPage .Section }}
                {{ $ancestor := .Section.IsAncestor .CurrentPage }}
                {{ $collapsed := true }}

                {{ if or $self $ancestor (not $collapsed) }}
                <ul class="list-unstyled ml-2">
                  {{ range (where .Section.Pages "Params.bookhidden" "ne" true) }}  
                    {{ if .IsSection }}
                    <li data-nav-id="{{.RelPermalink}}" class="nav-item my-1 
                        {{- if .IsAncestor $.CurrentPage}} parent{{end}}
                        {{- if eq .RelPermalink $.CurrentPage}} active{{end}}
                        ">
                      {{ template "page-link" (dict "Page" . "CurrentPage" $.CurrentPage) }}
                      {{ template "section-children" (dict "Section" . "CurrentPage" $.CurrentPage) }}
                    </li>
                  {{ else if and .IsPage .Content }}
                  <li data-nav-id="{{.RelPermalink}}" class="nav-item my-1 
                    {{- if eq .RelPermalink $.CurrentPage.RelPermalink}} active{{end -}}">
       
                      {{ template "page-link" (dict "Page" . "CurrentPage" $.CurrentPage) }}
                    </li>
                  {{ end }}                  
                    
                  {{ end }}
                </ul>
                {{ end }}
              {{ end }}

              {{ define "page-link" }}
              {{ if true }}
                <a href="{{ .Page.RelPermalink }}" class="nav-link p-0
                    {{- if .Page.IsSection }} collapsed {{ end }}
                    {{- if eq .CurrentPage .Page }} active {{ end }}">
                    {{- if .Page.IsSection }} <h6> {{ end }}
                      {{- partial "title" .Page -}}
                    {{- if .Page.IsSection }} </h6> {{ end }}
                </a>
              {{ else }}
                <span>{{- partial "title" .Page -}}</span>
              {{ end }}
            {{ end }} 
          <!-- ----------------------- END OF MENU FOR CURRENT SECTION ONLY ----------------------- -->          
        </ul>
    </div>
</nav>